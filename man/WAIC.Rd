% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/WAIC.R
\name{WAIC}
\alias{WAIC}
\title{Calculate the Watanabe-Akaike Information Criterion (WAIC)}
\usage{
WAIC(model)
}
\arguments{
\item{model}{A fitted model object created with \link{Nemodel} with \code{loglik = TRUE} to record log-likelihoods.}
}
\value{
A structured class object containing three slots:
\itemize{
\item \code{waic}: The WAIC score, quantifying the trade-off between model fit and complexity.
\item \code{lppd}: The log-predictive density term, reflecting the model's fit.
\item \code{p_waic}: The effective number of parameters, representing model complexity.
}
}
\description{
This function computes the Watanabe-Akaike Information Criterion
(WAIC), also known as the Widely Applicable Information Criterion (Watanabe,
2010). This robust metric is used for model comparison and selection within Bayesian
frameworks, offering a way to balance model fit and complexity. The WAIC estimates
out-of-sample predictive accuracy, penalising overfitting.
}
\details{
The WAIC is computed using the following equations, which incorporate both the mean log-likelihood and its variance:
\itemize{
\item \strong{Log Pointwise Predictive Density (LPPD)}:
\deqn{LPPD = \sum_{nijkc=1}^{NIJKC} \ln (\frac{1}{Sim_{tot}} \sum_{sim=1}^{Sim_{tot}} e^{\log \ell_{nijkc,sim}})} \cr
where:
\itemize{
\item \eqn{\log \ell_{nijkc,sim}} is the log-likelihood value calculated from simulation \eqn{sim} for species \eqn{n} at site \eqn{i} in sample \eqn{j} in replicate \eqn{k} (except for \code{'seq_read'} protocol) during campaign. \eqn{c}
\item \eqn{Sim_{tot}} is the total number of simulations (MCMC samples) computed.
\cr
}
\item \strong{Effective Number of Parameters (p_{WAIC})}:
\deqn{p_{WAIC} = \sum_{nijkc=1}^{NIJKC} \frac{1}{Sim_{tot}} \sum_{sim=1}^{Sim_{tot}} \left(\log \ell_{nijkc,sim} - \overline{\log \ell_{nijkc}} \right)^2} \cr
where:
\itemize{
\item \eqn{\log \ell_{nijkc,sim}} is the log-likelihood value calculated from simulation \eqn{sim} for species \eqn{n} at site \eqn{i} in sample \eqn{j} in replicate \eqn{k} (except for \code{'seq_read'} protocol) during campaign. \eqn{c}
\item \eqn{\overline{\log \ell_{nijkc}}} is the mean log-likelihood value across all simulations for species \eqn{n} at site \eqn{i} in sample \eqn{j} in replicate \eqn{k} (except for \code{'seq_read'} protocol) during campaign. \eqn{c}
\item \eqn{Sim_{tot}} is the total number of simulations (MCMC samples) computed.
\cr
}
\item \strong{WAIC Score}:
\deqn{WAIC = -2 \times LPPD - p_{WAIC}}
\cr
These computations are performed internally, yielding a scalar WAIC value that summarises the overall performance of the model.
}
}
\examples{
# Load fitted model
data(model_PCR_rep)

# Calculate the WAIC
WAIC(model_PCR_rep)

}
\seealso{
\code{Nemodel()}, \code{covarray()}
}
